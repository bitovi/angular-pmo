@let restaurant = restaurantResource.value();
@let orderResource = createOrderResource;
@let order = orderResource.value();

<div class="order-form">
  @if (order) {
    <pmo-order-details [order]="order"></pmo-order-details>
    <p><button (click)="startNewOrder()">Place another order</button></p>
  } @else {
    <h2>Order here</h2>
    @if (restaurant) {
      <form [formGroup]="orderForm" (ngSubmit)="onSubmit()">
        <pmo-menu-items
          [menu]="restaurant.menu"
          formControlName="items"
        ></pmo-menu-items>
        <div class="form-group">
          <label class="control-label">Name:</label>
          <input
            name="name"
            type="text"
            class="form-control"
            formControlName="name"
          />
          <p>Please enter your name.</p>
        </div>
        <div class="form-group">
          <label class="control-label">Address:</label>
          <input
            name="address"
            type="text"
            class="form-control"
            formControlName="address"
          />
          <p class="help-text">Please enter your address.</p>
        </div>
        <div class="form-group">
          <label class="control-label">Phone:</label>
          <input
            name="phone"
            type="text"
            pmoOnlyNumbers
            class="form-control"
            formControlName="phone"
          />
          <p class="help-text">Please enter your phone number.</p>
        </div>
        <div class="submit">
          <h4>Total: {{ orderTotal() | currency }}</h4>
          @if (orderResource.isLoading()) {
            <div class="loading"></div>
          }
          <button
            type="submit"
            [disabled]="!orderForm.valid || orderResource.isLoading()"
            class="btn"
          >
            Place My Order!
          </button>
        </div>
      </form>
    }
  }
</div>
