<div class="restaurants">
  <h2 class="page-header">Restaurants</h2>
  <form class="form" [formGroup]="form">
    @let statesResource = this.statesResource;
    <div class="form-group">
      <label>State</label>
      <select class="formControl" formControlName="state">
        @if (statesResource.isLoading()) {
          <option value="">Loading...</option>
        }
        @if (!statesResource.isLoading()) {
          <option value="">Choose a state</option>
          @let states = statesResource.value()?.data;
          @for (state of states; track state) {
            <option [value]="state.short">
              {{ state.name }}
            </option>
          }
        }
      </select>
    </div>
    @let citiesResource = this.citiesResource;
    <div class="form-group">
      <label>City</label>
      <select class="formControl" formControlName="city">
        @if (citiesResource.isLoading()) {
          <option value="">Loading...</option>
        }
        @if (!citiesResource.isLoading()) {
          <option value="">Choose a city</option>
          @let cities = citiesResource.value().data;
          @for (city of cities; track city) {
            <option [value]="city.name">
              {{ city.name }}
            </option>
          }
        }
      </select>
    </div>
  </form>

  @let restaurantsResource = this.restaurantsResource;
  @if (restaurantsResource.isLoading()) {
    <div class="restaurant loading"></div>
  }
  @let restaurants = restaurantsResource.value().data;
  @if (restaurants?.length) {
    @for (restaurant of restaurants; track restaurant) {
      <div class="restaurant">
        <img
          src="{{ restaurant.images.thumbnail | imageUrl }}"
          width="100"
          height="100"
        />
        <h3>{{ restaurant.name }}</h3>
        @if (restaurant.address) {
          <div class="address">
            {{ restaurant.address.street }}<br />{{ restaurant.address.city }},
            {{ restaurant.address.state }} {{ restaurant.address.zip }}
          </div>
        }
        <div class="hours-price">
          $$$<br />
          Hours: M-F 10am-11pm
          <span class="open-now">Open Now</span>
        </div>
        <a class="btn" [routerLink]="['/restaurants', restaurant.slug]">
          Details
        </a>
        <br />
      </div>
    }
  }
</div>
